# 第18章：统计光学与散斑

当相干光从粗糙表面反射或透过随机介质传播时，会产生一种称为散斑的随机强度图案。这种现象在激光物理、光学成像和计算机图形学中都有重要应用。本章将建立光场的统计描述框架，分析散斑的形成机理和统计特性，并探讨其在成像系统中的影响。我们将看到，散斑不仅是相干成像的固有限制，也可以作为测量和成像的有力工具。

## 学习目标

完成本章学习后，您将能够：
1. 使用统计方法描述随机光场的一阶和二阶特性
2. 推导散斑强度的概率分布（Rayleigh分布和Rice分布）
3. 分析粗糙表面散射的统计模型，包括Kirchhoff近似
4. 计算成像系统中散斑的统计特性和相关函数
5. 设计散斑抑制方案和利用散斑进行测量
6. 将散斑现象与体积渲染方程建立联系

## 章节大纲

## 18.1 光场的统计描述

在许多实际情况中，光场的精确值是未知的或快速变化的，需要使用统计方法来描述。这种随机性可能源于光源的热涨落、传播介质的不均匀性或散射表面的粗糙度。

### 18.1.1 随机光场的表征

考虑一个标量光场 U(**r**, t)，它是空间位置 **r** 和时间 t 的随机函数。我们使用复解析信号表示：

U(**r**, t) = A(**r**, t) exp[iφ(**r**, t)]

其中 A(**r**, t) 是振幅，φ(**r**, t) 是相位。

对于随机过程，我们定义系综平均：

⟨U(**r**, t)⟩ = ∫ U(**r**, t) p(U) dU

其中 p(U) 是概率密度函数。

**平稳性和各态历经性**：

如果统计特性不随时间平移改变，则过程是平稳的：
⟨U(**r**, t)⟩ = ⟨U(**r**, t + τ)⟩

如果系综平均等于时间平均，则过程是各态历经的：
⟨U(**r**, t)⟩ = lim(T→∞) (1/T) ∫₀ᵀ U(**r**, t) dt

**空间平稳性**：

类似地，如果统计特性不随空间平移改变：
⟨U(**r**, t)⟩ = ⟨U(**r** + **Δr**, t)⟩

这在均匀介质和平移不变系统中常见。

### 18.1.2 一阶统计量

**平均强度**：
I(**r**, t) = ⟨|U(**r**, t)|²⟩ = ⟨U(**r**, t)U*(**r**, t)⟩

**归一化一阶相关函数**：
g⁽¹⁾(**r₁**, t₁; **r₂**, t₂) = ⟨U*(**r₁**, t₁)U(**r₂**, t₂)⟩ / √[I(**r₁**, t₁)I(**r₂**, t₂)]

对于平稳随机过程，相关函数仅依赖于时间差 τ = t₂ - t₁。

**互强度函数**：

定义互强度为：
J(**r₁**, **r₂**, τ) = ⟨U*(**r₁**, t)U(**r₂**, t + τ)⟩

它描述了两点间场的相关性。对于准单色光（Δω/ω₀ ≪ 1）：
J(**r₁**, **r₂**, τ) ≈ J(**r₁**, **r₂**, 0) exp(-iω₀τ)

**相干度的物理意义**：

复相干度 |γ⁽¹⁾| 的值域为 [0, 1]：
- |γ⁽¹⁾| = 1：完全相干
- 0 < |γ⁽¹⁾| < 1：部分相干
- |γ⁽¹⁾| = 0：非相干

相干度直接影响干涉条纹的可见度：
V = (Imax - Imin)/(Imax + Imin) = 2√(I₁I₂)/(I₁ + I₂) |γ⁽¹⁾|

### 18.1.3 二阶统计量

**强度相关函数**：
G⁽²⁾(**r₁**, t₁; **r₂**, t₂) = ⟨I(**r₁**, t₁)I(**r₂**, t₂)⟩

**归一化二阶相关函数**：
g⁽²⁾(**r₁**, t₁; **r₂**, t₂) = G⁽²⁾(**r₁**, t₁; **r₂**, t₂) / [⟨I(**r₁**, t₁)⟩⟨I(**r₂**, t₂)⟩]

对于高斯随机过程，存在重要关系：
g⁽²⁾(**r₁**, t₁; **r₂**, t₂) = 1 + |g⁽¹⁾(**r₁**, t₁; **r₂**, t₂)|²

**高斯矩定理**：

对于零均值复高斯随机过程，所有高阶矩可由二阶矩完全确定：
⟨U₁U₂...UₙU*ₙ₊₁...U*₂ₙ⟩ = ∑(所有配对) ∏ ⟨UᵢU*ⱼ⟩

这极大简化了统计计算。

**强度涨落的物理含义**：

二阶相关函数描述强度涨落：
- g⁽²⁾ = 1：泊松统计（相干态）
- g⁽²⁾ > 1：超泊松统计（热光）
- g⁽²⁾ < 1：亚泊松统计（需要量子描述）

**Hanbury Brown-Twiss效应**：

强度相关可用于测量恒星角直径：
g⁽²⁾(d) = 1 + |γ⁽¹⁾(d)|²

其中 d 是探测器间距，通过测量 g⁽²⁾ 可推断源的空间相干性。

### 18.1.4 空间相干函数

定义互相干函数：
Γ(**r₁**, **r₂**, τ) = ⟨U*(**r₁**, t)U(**r₂**, t + τ)⟩

复相干度：
γ(**r₁**, **r₂**, τ) = Γ(**r₁**, **r₂**, τ) / √[Γ(**r₁**, **r₁**, 0)Γ(**r₂**, **r₂**, 0)]

相干面积：
Ac = ∫∫ |γ(**r₁**, **r₂**, 0)|² d²**r₂**

**相干长度的估计**：

横向相干长度（van Cittert-Zernike定理）：
lc⊥ ≈ λz/D

其中 z 是传播距离，D 是源的横向尺寸。

纵向相干长度（时间相干性）：
lc∥ = cτc = λ²/Δλ

其中 τc 是相干时间，Δλ 是光源带宽。

**相干体积**：

三维相干体积定义为：
Vc = lc⊥² × lc∥

它表征了光场中相干单元的大小。

**传播中的相干性演化**：

自由空间传播中，相干函数通过Huygens-Fresnel原理演化：
Γ(P₁, P₂) = ∫∫ K*(P₁, Q)K(P₂, Q)Γ₀(Q, Q') dQ dQ'

其中 K 是传播核。

### 18.1.5 高斯随机过程模型

许多光学系统中，光场可以近似为圆复高斯随机过程。其特点是：

1. 实部和虚部独立且具有相同的高斯分布
2. 概率密度函数：
   p(U) = (1/πσ²) exp(-|U|²/σ²)
   
3. 所有高阶矩可由二阶矩确定（高斯矩定理）

**中心极限定理的应用**：

当大量独立随机贡献叠加时，根据中心极限定理：
U = ∑ₙ Uₙ → 高斯分布（N → ∞）

这解释了为什么散斑场通常是高斯的。

**联合概率分布**：

对于两个位置的场，联合高斯分布为：
p(U₁, U₂) = (1/π²det[C]) exp(-**U**†C⁻¹**U**)

其中协方差矩阵：
C = [⟨|U₁|²⟩    ⟨U₁U₂*⟩]
    [⟨U₁*U₂⟩   ⟨|U₂|²⟩]

**条件概率和预测**：

给定 U₁，U₂ 的条件期望值：
⟨U₂|U₁⟩ = (⟨U₂U₁*⟩/⟨|U₁|²⟩) U₁

这在自适应光学和相位恢复中有重要应用。

### 18.1.6 功率谱密度

通过Wiener-Khintchine定理，相干函数与功率谱密度通过傅里叶变换相联系：

S(**k**, ω) = ∫∫ Γ(**r**, τ) exp[i(**k**·**r** - ωτ)] d³**r** dτ

其中 **k** 是空间频率，ω 是时间频率。

**相干长度和相干时间**：
lc = ∫ |γ(**r**, 0)|² d**r**
τc = ∫ |γ(0, τ)|² dτ

**谱相干度**：

定义谱相干度函数：
W(**r₁**, **r₂**, ω) = ∫ Γ(**r₁**, **r₂**, τ) exp(iωτ) dτ

它描述了不同频率分量的空间相干性。

**准单色近似**：

当 Δω/ω₀ ≪ 1 时：
S(**k**, ω) ≈ S(**k**) × S(ω)

空间和时间特性可分离处理。

**功率谱的物理意义**：

- S(**k**) 描述空间结构的尺度分布
- S(ω) 描述时间涨落的频率成分
- 带宽 Δω 决定相干时间：τc ≈ 2π/Δω

**测量方法**：

1. 直接法：傅里叶变换测量的相关函数
2. 间接法：通过干涉仪扫描获得
3. 光谱分析仪：直接测量 S(ω)

## 18.2 散斑的形成与统计

散斑是相干光照射粗糙表面或通过随机介质后形成的随机强度图案。理解散斑的统计特性对于光学系统设计和成像质量分析至关重要。

### 18.2.1 散斑现象的物理起源

当相干光照射到粗糙度与波长相当或更大的表面时，不同位置的散射光具有随机相位差。在观察平面上，这些散射光相干叠加形成散斑图案。

考虑 N 个散射点，观察点的复振幅为：

U = ∑ₖ₌₁ᴺ Aₖ exp(iφₖ)

其中 Aₖ 和 φₖ 分别是第 k 个散射光的振幅和相位。

对于完全发展的散斑（N → ∞），根据中心极限定理，U 的实部和虚部趋于高斯分布。

**相位随机性的来源**：

1. **表面高度变化**：
   φₖ = 2k hₖ cos θᵢ + k·rₖ
   
   其中 hₖ 是表面高度，θᵢ 是入射角，rₖ 是散射点位置。

2. **路径长度差异**：
   对于体散射介质：
   φₖ = k ∫ n(s) ds
   
   其中积分沿第 k 条散射路径。

**完全发展散斑的条件**：

1. 表面粗糙度：σₕ > λ/4
2. 散射点数：N ≫ 1
3. 相位均匀分布：φₖ ∈ [0, 2π]
4. 振幅统计独立性

**散斑的空间尺度**：

散斑的典型尺寸由系统的点扩散函数决定：
- 自由空间：δs ≈ λz/D
- 成像系统：δs ≈ λf#
- 其中 f# = f/D 是光圈数

### 18.2.2 振幅和强度的一阶统计

**振幅分布**：

设 U = Uᵣ + iUᵢ，其中 Uᵣ 和 Uᵢ 是独立的零均值高斯随机变量，方差为 σ²。

振幅 A = |U| = √(Uᵣ² + Uᵢ²) 的概率密度函数为：

p(A) = (A/σ²) exp(-A²/2σ²),  A ≥ 0

这是Rayleigh分布。

**强度分布**：

强度 I = |U|² = A² 的概率密度函数为：

p(I) = (1/⟨I⟩) exp(-I/⟨I⟩),  I ≥ 0

其中 ⟨I⟩ = 2σ² 是平均强度。这是负指数分布。

**统计特性**：

振幅的矩：
- 平均值：⟨A⟩ = σ√(π/2) ≈ 1.253σ
- 方差：Var(A) = (2 - π/2)σ² ≈ 0.429σ²
- 最概然值：Aₘₚ = σ

强度的矩：
- 平均值：⟨I⟩ = 2σ²
- 方差：Var(I) = ⟨I⟩²
- 标准差：σᵢ = ⟨I⟩
- n阶矩：⟨Iⁿ⟩ = n! ⟨I⟩ⁿ

**概率分布的验证**：

实验上可通过直方图验证：
1. 测量大量独立散斑点的强度
2. 归一化：I' = I/⟨I⟩
3. 验证：p(I') = exp(-I')

**极值统计**：

N个独立散斑中的最大强度：
P(Iₘₐₓ < I) = [1 - exp(-I/⟨I⟩)]ᴺ

大N时，Iₘₐₓ ≈ ⟨I⟩ ln N

### 18.2.3 部分发展散斑：Rice分布

当存在确定性分量（如镜面反射）时，复振幅为：

U = Us + Un

其中 Us 是确定性分量，Un 是随机分量。

振幅的概率密度函数变为Rice分布：

p(A) = (A/σ²) exp[-(A² + |Us|²)/2σ²] I₀(A|Us|/σ²)

其中 I₀ 是零阶修正贝塞尔函数。

**Rice参数**：
K = |Us|²/(2σ²)

- K = 0：完全发展散斑（Rayleigh分布）
- K ≫ 1：接近高斯分布

### 18.2.4 散斑的二阶统计

**强度相关函数**：

对于平稳散斑场，归一化强度相关函数为：

g⁽²⁾(Δ**r**) = ⟨I(**r**)I(**r** + Δ**r**)⟩/⟨I⟩² = 1 + |μ(Δ**r**)|²

其中 μ(Δ**r**) 是复相干因子。

**散斑尺寸**：

平均散斑尺寸可通过相关函数的半高宽定义：

δs = ∫ |μ(Δ**r**)|² d²(Δ**r**)

对于远场散斑：
δs ≈ λz/D

其中 λ 是波长，z 是观察距离，D 是照明区域尺寸。

### 18.2.5 散斑对比度

散斑对比度定义为：

C = σᵢ/⟨I⟩

其中 σᵢ 是强度标准差。

对于不同类型的散斑：

1. **完全发展散斑**：C = 1
2. **部分发展散斑**：C = √(1/(1 + K))
3. **多重独立散斑叠加**：C = 1/√N

### 18.2.6 偏振散斑

当考虑偏振时，需要使用Stokes参数描述：

**Sᵢ** = [S₀, S₁, S₂, S₃]ᵀ

其中：
- S₀ = ⟨Iₓ⟩ + ⟨Iᵧ⟩（总强度）
- S₁ = ⟨Iₓ⟩ - ⟨Iᵧ⟩（线偏振）
- S₂ = ⟨2Re(UₓU*ᵧ)⟩（45°线偏振）
- S₃ = ⟨2Im(UₓU*ᵧ)⟩（圆偏振）

偏振度：
P = √(S₁² + S₂² + S₃²)/S₀

## 18.3 粗糙表面散射

粗糙表面的散射是产生散斑的主要机制之一。本节将建立粗糙表面的统计模型，并分析其散射特性。

### 18.3.1 表面粗糙度的统计描述

粗糙表面可用高度函数 h(x, y) 描述，其统计特性包括：

**高度分布**：

假设高度服从高斯分布：
p(h) = (1/σₕ√2π) exp(-h²/2σₕ²)

其中 σₕ 是均方根粗糙度。

**自相关函数**：

表面高度的自相关函数：
C(ξ, η) = ⟨h(x, y)h(x + ξ, y + η)⟩

常用模型：
- 高斯相关：C(ρ) = σₕ² exp(-ρ²/l²c)
- 指数相关：C(ρ) = σₕ² exp(-ρ/lc)

其中 lc 是相关长度，ρ = √(ξ² + η²)。

**功率谱密度**：

表面的功率谱密度是自相关函数的傅里叶变换：
S(kₓ, kᵧ) = ∫∫ C(ξ, η) exp[-i(kₓξ + kᵧη)] dξ dη

### 18.3.2 Kirchhoff近似

对于缓变粗糙表面（σₕ ≪ lc），可使用Kirchhoff近似（也称物理光学近似）。

**边界条件**：

在表面上，场满足：
U⁺ - U⁻ = 0
∂U⁺/∂n - ∂U⁻/∂n = 0

其中 n 是表面法向量。

**散射振幅**：

入射平面波 exp(i**k**ᵢ·**r**) 的散射场：

Us(**r**) = (ik/2π) ∫∫ exp(ikR)/R [1 + cos θ] exp[i(**k**ᵢ - **k**s)·**r**'] dS'

其中 R = |**r** - **r**'|，θ 是散射角。

### 18.3.3 相位扰动模型

对于小粗糙度（σₕ ≪ λ），可使用相位扰动近似：

**反射系数**：

r(x, y) ≈ r₀ exp[i2kᵢ cos θᵢ h(x, y)]

其中 r₀ 是光滑表面的反射系数，θᵢ 是入射角。

**散射截面**：

微分散射截面：
dσ/dΩ = A cos² θᵢ cos θs |r₀|² S[(**k**s - **k**ᵢ)∥]

其中 (**k**s - **k**ᵢ)∥ 是动量转移的平行分量。

### 18.3.4 散射系数的统计特性

**相干散射**（镜面方向）：

⟨Us⟩ = r₀ exp(-g)

其中 g = (2k cos θᵢ σₕ)² 是粗糙度因子。

**非相干散射**：

⟨|Us|²⟩ - |⟨Us⟩|² = |r₀|² [exp(2g Re[ρ]) - exp(-2g)]

其中 ρ 是归一化相关函数。

**角度分布**：

散射强度的角度分布取决于表面相关函数：

I(θs) ∝ ∫∫ C(ξ, η) exp[ik(sin θs - sin θᵢ)ξ] dξ dη

### 18.3.5 多重散射效应

对于强粗糙表面，需考虑多重散射：

**增强后向散射**：

在精确后向方向（θs = -θᵢ），由于相干效应，散射强度增强：

I(180°)/I(θ) ≈ 2

**阴影效应**：

掠入射时的阴影函数：
S(θᵢ, θs) = [1 + Λ(θᵢ)]⁻¹[1 + Λ(θs)]⁻¹

其中 Λ(θ) = (√2 σₕ/lc) cot θ。

### 18.3.6 与体积渲染的联系

粗糙表面散射可纳入体积渲染框架：

**等效体积表示**：

将表面散射转换为薄层体积散射：

σs(z) = σ₀ δ(z - h(x, y))

其中 σ₀ 包含表面反射特性。

**BSDF与相位函数**：

表面BSDF可表示为等效相位函数：

p(**ω**ᵢ → **ω**s) = (4π/σ₀) fs(**ω**ᵢ, **ω**s) δ(z)

这建立了表面散射与体积渲染方程的联系。

## 18.4 相干成像中的散斑

相干成像系统中的散斑特性与成像系统的点扩散函数密切相关。本节分析成像过程中散斑的形成和传播。

### 18.4.1 成像系统的统计描述

**成像方程**：

相干成像系统的输出场：

Ui(**r**) = ∫∫ h(**r** - **r**') U₀(**r**') d²**r**'

其中 h(**r**) 是相干点扩散函数，U₀(**r**) 是物平面的场分布。

**统计传递**：

输出场的统计特性：

⟨Ui(**r₁**)U*i(**r₂**)⟩ = ∫∫∫∫ h(**r₁** - **r**')h*(**r₂** - **r**'') × 
                          ⟨U₀(**r**')U*₀(**r**'')⟩ d²**r**' d²**r**''

### 18.4.2 图像散斑与物体散斑

**物体散斑**：

当物体本身产生散斑场时：
- 散斑尺寸由照明条件决定
- 成像系统对散斑进行空间滤波
- 输出散斑受系统分辨率限制

**图像散斑**：

成像系统引入的散斑：
- 由系统孔径的衍射效应产生
- 散斑尺寸：δᵢ ≈ 1.22λf/D
- 其中 f 是焦距，D 是孔径直径

### 18.4.3 传递函数的统计特性

**相干传递函数**：

CTF = ℱ{h(**r**)} = P(**k**)

其中 P(**k**) 是光瞳函数。

**散斑传递函数**：

对于散斑输入，有效传递函数变为：

STF(**k**) = |CTF(**k**)|² = |P(**k**)|²

这相当于非相干成像的光学传递函数(OTF)。

### 18.4.4 分辨率与散斑的关系

**Rayleigh判据的修正**：

在散斑场中，两点的可分辨性取决于：

1. 确定性分辨率：Δr > 1.22λ/NA
2. 统计分辨率：需要足够的散斑平均

**散斑平均数**：

分辨单元内的独立散斑数：

N = (物体尺寸/散斑尺寸) × (成像孔径/衍射极限)

**信噪比**：

散斑场中的信噪比：
SNR = √N × (信号对比度)

### 18.4.5 动态散斑

**时间相关性**：

动态散斑的时间相关函数：

g⁽¹⁾(τ) = ⟨U*(t)U(t + τ)⟩/⟨|U|²⟩

**速度测量**：

通过散斑的时间相关性可测量物体运动：

τc = λ/(2v sin(θ/2))

其中 v 是横向速度，θ 是散射角。

**散斑跟踪**：

横向位移 Δx 导致的相位变化：
Δφ = 2π(Δx/λ) sin θ

### 18.4.6 部分相干成像

**van Cittert-Zernike定理的应用**：

扩展光源的空间相干性：

μ₁₂ = ∫∫ I(ξ, η) exp[ik(ξx₁₂ + ηy₁₂)/z] dξ dη / ∫∫ I(ξ, η) dξ dη

**散斑对比度降低**：

部分相干照明下的散斑对比度：

C = C₀ × |μ₁₂|

其中 C₀ 是完全相干时的对比度。

### 18.4.7 计算成像中的散斑模拟

**数值生成**：

散斑场的数值模拟：

U(x, y) = ∑ₙ Aₙ exp[i(kₓₙx + kᵧₙy + φₙ)]

其中 φₙ 是[0, 2π]的随机相位。

**与体积渲染的结合**：

在体积渲染中加入散斑效应：

L(x, y) = ∫ σₜ(s) exp[-∫ σₜ(s') ds'] × 
         [Ld(s) + S(s, x, y)] ds

其中 S(s, x, y) 是散斑调制项。

## 18.5 散斑的应用与抑制

散斑既是相干成像的限制因素，也是强大的测量工具。本节探讨散斑的实际应用和抑制技术。

### 18.5.1 散斑干涉测量

**电子散斑干涉（ESPI）**：

物体变形前后的散斑场：
U₁ = Ur + U₀
U₂ = Ur + U₀ exp(iΔφ)

其中 Ur 是参考光，Δφ 是变形引起的相位变化。

干涉条纹对应于：
Δφ = 2π(2**d**·**n**)/λ = 2πm

其中 **d** 是位移矢量，**n** 是观察方向。

**剪切散斑干涉**：

测量位移梯度：
I(x, y) = |U(x, y) + U(x + δx, y)|²

条纹对应于：
∂u/∂x = mλ/(2δx)

### 18.5.2 散斑相关技术

**数字图像相关（DIC）**：

互相关函数：
C(Δx, Δy) = ∫∫ I₁(x, y)I₂(x + Δx, y + Δy) dx dy

峰值位置给出位移量。

**激光散斑测速（LSV）**：

速度与相关时间的关系：
v = δs/τc

其中 δs 是散斑尺寸，τc 是相关时间。

**散斑相关光谱**：

通过散斑的光谱分析获得动态信息：
G(τ) = ⟨I(t)I(t + τ)⟩ = ⟨I⟩²[1 + g₁²(τ)]

### 18.5.3 多样性方法抑制散斑

**角度多样性**：

使用 N 个独立角度照明：
C = C₀/√N

实现方法：旋转散射体或多角度照明。

**频率多样性**：

使用带宽 Δλ 的光源：
相干长度：lc = λ²/Δλ
独立散斑数：N ≈ L/lc

其中 L 是光程差范围。

**偏振多样性**：

组合正交偏振态：
I = Ix + Iy

散斑对比度降低因子：1/√2

### 18.5.4 计算机图形学中的散斑模拟

**程序化散斑纹理**：

散斑强度分布：
I(x, y) = |∑ₙ exp[i(2πfₙ·**r** + φₙ)]|²

其中 fₙ 是空间频率，φₙ 是随机相位。

**基于物理的散斑渲染**：

1. 表面微结构建模
2. 相干光传播计算
3. 统计特性保持

**实时散斑效果**：

使用预计算的散斑图案：
I_final = I_base × (1 + m × S(u, v))

其中 m 是调制深度，S(u, v) 是散斑纹理。

### 18.5.5 与体积渲染的统一

**散斑作为体积现象**：

将散斑纳入体积渲染方程：

L(**x**, **ω**) = ∫₀ᴸ σₜ(s) exp[-∫₀ˢ σₜ(t) dt] × 
                [Le(s) + Ls(s) × M(s, **x**)] ds

其中 M(s, **x**) 是散斑调制函数。

**相干体积渲染**：

考虑相位的体积渲染：
U(**x**) = ∫₀ᴸ σₛ(s) exp[ikn(s)s] exp[-∫₀ˢ σₜ(t) dt] Us(s) ds

**蒙特卡洛散斑**：

路径积分中加入相位：
⟨L⟩ = ∫ L(**x**) |∑_paths exp(iφ_path)|² d**x**

### 18.5.6 先进散斑控制技术

**自适应光学补偿**：

使用空间光调制器补偿散斑相位：
U_corrected = U_speckle × exp(-iφ_speckle)

**计算去散斑**：

基于统计模型的去噪：
I_denoised = arg min_I [||I - I_observed||² + λR(I)]

其中 R(I) 是正则化项。

**深度学习方法**：

训练网络学习散斑到清晰图像的映射：
I_clear = CNN(I_speckle, θ)

### 18.5.7 未来展望

**量子散斑**：

利用量子纠缠光源的散斑特性：
- 亚散粒噪声成像
- 量子光学相干断层扫描

**计算散斑全息**：

结合散斑与全息技术：
- 散斑场的相位恢复
- 三维散斑重建

## 本章小结

本章建立了统计光学的基本框架，深入分析了散斑现象的物理机理和统计特性。关键要点：

1. **统计描述**：光场的随机性通过一阶和二阶相关函数完整描述，高斯随机过程模型适用于大多数情况
2. **散斑统计**：完全发展散斑的强度服从负指数分布，振幅服从Rayleigh分布；部分发展散斑服从Rice分布
3. **粗糙表面散射**：Kirchhoff近似和相位扰动模型提供了散射场的统计特性，可转化为体积渲染框架
4. **成像系统**：散斑通过成像系统传播时受点扩散函数调制，影响分辨率和信噪比
5. **应用技术**：散斑既可用于精密测量（ESPI、DIC），也可通过多样性方法有效抑制
6. **统一框架**：散斑现象可纳入体积渲染方程，通过相位调制实现物理准确的渲染

## 练习题

### 基础题

**练习18.1**：推导高斯随机光场的强度概率分布
已知复振幅 U = Ur + iUi，其中 Ur 和 Ui 是独立的零均值高斯随机变量，方差均为 σ²。证明强度 I = |U|² 服从参数为 ⟨I⟩ = 2σ² 的负指数分布。

*提示*：使用变量变换从 (Ur, Ui) 到 (I, φ)，其中 φ 是相位。

<details>
<summary>答案</summary>

联合概率密度：
p(Ur, Ui) = (1/2πσ²) exp[-(Ur² + Ui²)/2σ²]

变换到极坐标：U = √I exp(iφ)
雅可比行列式：|J| = 1/2

p(I, φ) = p(Ur, Ui)|J| = (1/4πσ²) exp(-I/2σ²)

对 φ 积分（0 到 2π）：
p(I) = (1/2σ²) exp(-I/2σ²) = (1/⟨I⟩) exp(-I/⟨I⟩)

其中 ⟨I⟩ = 2σ²。
</details>

**练习18.2**：计算散斑对比度
N 个独立的完全发展散斑场叠加，每个场的平均强度为 I₀。求合成散斑场的对比度。

*提示*：利用独立随机变量和的方差性质。

<details>
<summary>答案</summary>

每个散斑场：⟨Ii⟩ = I₀，Var(Ii) = I₀²（负指数分布）

总强度：I = ∑ᵢ₌₁ᴺ Ii
平均值：⟨I⟩ = N I₀
方差：Var(I) = N I₀²（独立性）

对比度：
C = σI/⟨I⟩ = √(N I₀²)/(N I₀) = 1/√N
</details>

**练习18.3**：Kirchhoff近似下的镜面反射
使用Kirchhoff近似，计算正入射平面波从均方根粗糙度为 σh 的高斯粗糙表面的镜面反射系数。

*提示*：计算相干散射分量 ⟨Us⟩。

<details>
<summary>答案</summary>

相位变化：Δφ = 2k h(x,y)（正入射）

反射系数：r = r₀ exp(i2kh)

平均反射系数：
⟨r⟩ = r₀⟨exp(i2kh)⟩ = r₀ exp(-2k²⟨h²⟩)
    = r₀ exp(-2k²σh²) = r₀ exp(-g/2)

其中 g = (2kσh)² 是粗糙度因子。
</details>

### 挑战题

**练习18.4**：部分相干光的散斑统计
推导部分相干光（相干度 |γ₁₂| < 1）产生的散斑对比度。考虑两个部分相干的点源。

*提示*：使用 van Cittert-Zernike 定理和二阶相关函数。

<details>
<summary>答案</summary>

两点源的场：U = U₁ + U₂
互相干函数：⟨U₁*U₂⟩ = √(I₁I₂) γ₁₂

强度：I = |U₁|² + |U₂|² + 2Re(U₁*U₂)

平均强度：⟨I⟩ = I₁ + I₂
强度方差：Var(I) = I₁² + I₂² + 4I₁I₂|γ₁₂|²

对于 I₁ = I₂ = I₀/2：
C² = Var(I)/⟨I⟩² = (1 + |γ₁₂|²)/2

因此：C = √[(1 + |γ₁₂|²)/2]
</details>

**练习18.5**：动态散斑的速度测量极限
分析使用散斑相关技术测量横向速度的理论分辨率极限。给定激光波长 λ、散斑尺寸 δs 和探测器积分时间 T。

*提示*：考虑相关函数衰减到 1/e 的时间。

<details>
<summary>答案</summary>

散斑移动距离 δs 时相关性降到 1/e：
τc = δs/v

探测条件：T < τc（避免运动模糊）

速度分辨率由相关峰宽度决定：
Δτ ≈ λ/(πδs) × (δs/v) = λ/(πv)

相对速度分辨率：
Δv/v ≈ λ/(πvT) = λ/(πδs)（当 T = τc）

最小可测速度：vmin ≈ δs/T
最大可测速度：vmax ≈ δs × (采样率)
</details>

**练习18.6**：散斑场的相位恢复
给定散斑强度分布 I(x,y) 和部分相位信息（如边界条件），讨论相位恢复的可能性和唯一性。

*提示*：考虑 Gerchberg-Saxton 算法的收敛性。

<details>
<summary>答案</summary>

相位恢复问题：已知 |U|² = I，求 φ 使 U = √I exp(iφ)

约束条件：
1. 强度约束：|U|² = I（已知）
2. 支撑域约束：U 在某区域外为零
3. 平滑性约束：φ 连续可微

迭代算法：
1. 傅里叶域：施加孔径约束
2. 空间域：施加强度约束
3. 重复直到收敛

唯一性：
- 无额外约束时有平移和共轭模糊性
- 过采样因子 > 2 时通常可唯一恢复
- 散斑的随机性有助于打破对称性

收敛性依赖于：
- 初始猜测质量
- 噪声水平
- 约束强度
</details>

## 常见陷阱与错误

1. **混淆散斑尺寸定义**
   - 错误：使用强度半高宽作为散斑尺寸
   - 正确：使用自相关函数积分或第一零点

2. **忽略部分相干效应**
   - 错误：假设所有激光都产生 C = 1 的散斑
   - 正确：考虑光源相干性，多模激光器 C < 1

3. **错误的统计假设**
   - 错误：对非完全发展散斑使用 Rayleigh 分布
   - 正确：使用 Rice 分布或实验确定分布

4. **相位扰动模型的误用**
   - 错误：对大粗糙度表面使用相位扰动近似
   - 正确：检查 kσh ≪ 1 的条件

5. **忽略偏振效应**
   - 错误：标量理论处理所有散斑问题
   - 正确：金属表面等需要考虑偏振

## 最佳实践检查清单

### 散斑分析设计审查

- [ ] **统计模型选择**
  - 确认光源相干性（时间和空间）
  - 验证散斑类型（完全/部分发展）
  - 选择合适的概率分布

- [ ] **测量系统设计**
  - 散斑尺寸与探测器分辨率匹配
  - 采样满足 Nyquist 准则
  - 动态范围覆盖强度分布

- [ ] **数值计算考虑**
  - 相关函数的有效计算（FFT方法）
  - 统计量的样本数充足性
  - 边界效应的处理

- [ ] **抑制方法评估**
  - 多样性方法的独立性验证
  - 对比度降低与分辨率损失权衡
  - 实时性要求的满足

- [ ] **应用特定要求**
  - 干涉测量：相位稳定性
  - 速度测量：时间分辨率
  - 成像系统：信噪比优化

- [ ] **与渲染系统集成**
  - 物理准确性 vs 计算效率
  - 相干效应的选择性包含
  - 艺术控制参数的暴露