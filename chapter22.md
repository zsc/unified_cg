# 第22章：偏振光学基础

本章介绍偏振光学的数学基础，为后续章节中的偏振渲染提供理论框架。我们将系统地探讨偏振态的各种描述方法，包括琼斯矢量、斯托克斯参数和庞加莱球表示，并建立偏振器件的矩阵描述体系。

## 学习目标

完成本章后，您将能够：
1. 使用琼斯矢量和斯托克斯参数描述任意偏振态
2. 运用矩阵方法分析偏振器件的作用
3. 在庞加莱球上可视化偏振态的演化
4. 推导偏振度与相干性之间的关系
5. 设计复合偏振器件系统

## 22.1 偏振态的描述

### 22.1.1 电磁波的偏振现象

光作为横波，其电场矢量 **E** 在垂直于传播方向的平面内振动。考虑沿 z 轴传播的单色平面波，电场可表示为：

**E**(z,t) = **E**₀ exp[i(kz - ωt)]

其中 **E**₀ = (Ex₀, Ey₀, 0) 是复振幅矢量。偏振描述的是电场矢量端点在 xy 平面内的运动轨迹。

实电场为：
**E**ᴿ(z,t) = Re[**E**(z,t)] = Re[Ex₀ exp[i(kz - ωt)]]**e**x + Re[Ey₀ exp[i(kz - ωt)]]**e**y

写成分量形式：
Ex(z,t) = |Ex₀| cos(kz - ωt + φx)
Ey(z,t) = |Ey₀| cos(kz - ωt + φy)

其中 φx, φy 是各分量的初相位。相位差 δ = φy - φx 决定了偏振态的性质。

### 22.1.2 线偏振、圆偏振与椭圆偏振

通过消去时间参数，可得到电场矢量端点的轨迹方程：

(Ex/|Ex₀|)² + (Ey/|Ey₀|)² - 2(Ex/|Ex₀|)(Ey/|Ey₀|)cos δ = sin² δ

这是一般的椭圆方程。根据振幅比和相位差的不同值，可得到不同的偏振态：

**线偏振**（δ = 0 或 π）：
- 电场沿固定方向振动
- 偏振方向与 x 轴夹角：θ = arctan(|Ey₀|/|Ex₀|)
- 轨迹为直线

**圆偏振**（|Ex₀| = |Ey₀| = E₀，δ = ±π/2）：
- 右旋圆偏振（RCP）：δ = -π/2
- 左旋圆偏振（LCP）：δ = +π/2
- 电场矢量端点描绘半径为 E₀ 的圆

**椭圆偏振**（一般情况）：
- 电场矢量端点描绘椭圆
- 椭圆长轴与 x 轴夹角：ψ = (1/2)arctan[2|Ex₀||Ey₀|cos δ/(|Ex₀|² - |Ey₀|²)]
- 椭圆率：e = tan χ，其中 tan 2χ = 2|Ex₀||Ey₀|sin δ/(|Ex₀|² - |Ey₀|²)

### 22.1.3 偏振态的数学表示

完全偏振光的状态可用以下参数唯一确定：

**几何参数表示**：
- 方位角 ψ ∈ [-π/2, π/2]：椭圆长轴方向
- 椭圆率角 χ ∈ [-π/4, π/4]：描述椭圆的"扁平"程度
- 强度 I = |Ex₀|² + |Ey₀|²

**复振幅表示**：
- Ex₀ = |Ex₀| exp(iφx)
- Ey₀ = |Ey₀| exp(iφy)

两种表示之间的转换关系：
|Ex₀| = √I cos ψ cos χ - i√I sin ψ sin χ
|Ey₀| = √I sin ψ cos χ + i√I cos ψ sin χ

这些关系构成了后续琼斯矢量和斯托克斯参数描述的基础。

### 22.1.4 偏振椭圆的几何构造

**从瞬时电场到偏振椭圆**：

在固定位置 z = 0，电场矢量随时间的轨迹形成偏振椭圆。设：
Ex(t) = ax cos(ωt + φx)
Ey(t) = ay cos(ωt + φy)

引入无量纲坐标 ξ = Ex/ax，η = Ey/ay，消去时间得椭圆方程：
ξ² + η² - 2ξη cos δ = sin² δ

其中 δ = φy - φx。

**椭圆参数的推导**：

将椭圆方程转换到主轴坐标系 (ξ', η')：
[ξ'] = [cos ψ   sin ψ][ξ]
[η']   [-sin ψ  cos ψ][η]

主轴方向 ψ 由下式确定：
tan 2ψ = (2axay cos δ)/(ax² - ay²)

椭圆半长轴 a 和半短轴 b：
a² + b² = ax² + ay²
a²b² = (axay sin δ)²

椭圆率（ellipticity）：
ε = b/a = |tan χ|

其中椭圆率角 χ 满足：
sin 2χ = (2axay sin δ)/(ax² + ay²)

**手性判定**：

偏振光的手性（旋向）由电场矢量的旋转方向决定：
- 右旋（δ < 0）：从光源看，电场顺时针旋转
- 左旋（δ > 0）：从光源看，电场逆时针旋转

手性也可通过角动量密度判定：
**L** = ε₀**E** × **E**/2iω

对于圆偏振光，|**L**| = ε₀E₀²/2ω。

### 22.1.5 偏振态的能量考虑

**能量密度与Poynting矢量**：

电磁场能量密度：
u = (1/2)(ε₀|**E**|² + μ₀|**H**|²) = ε₀|**E**|²

时间平均能量密度：
⟨u⟩ = (ε₀/2)(|Ex₀|² + |Ey₀|²) = (ε₀/2)I

Poynting矢量：
**S** = **E** × **H** = (1/μ₀c)**E** × **B**

时间平均Poynting矢量：
⟨**S**⟩ = (cε₀/2)I **ẑ**

注意能量流与偏振态无关，但自旋角动量密度依赖于偏振态。

**偏振态的正交性与完备性**：

两个偏振态 **E**₁ 和 **E**₂ 的正交性定义为：
⟨**E**₁|**E**₂⟩ = Ex₁*Ex₂ + Ey₁*Ey₂ = 0

任意偏振态可在正交基下展开：
**E** = α₁**E**₁ + α₂**E**₂

其中展开系数：
α₁ = ⟨**E**₁|**E**⟩/⟨**E**₁|**E**₁⟩
α₂ = ⟨**E**₂|**E**⟩/⟨**E**₂|**E**₂⟩

能量守恒要求：
|α₁|²⟨**E**₁|**E**₁⟩ + |α₂|²⟨**E**₂|**E**₂⟩ = ⟨**E**|**E**⟩

## 22.2 琼斯矢量与琼斯矩阵

### 22.2.1 琼斯矢量的定义

对于完全偏振的单色光，琼斯矢量定义为电场复振幅的归一化列矢量：

**J** = [Ex₀]
      [Ey₀]

通常采用归一化形式，使得 |Ex₀|² + |Ey₀|² = 1。琼斯矢量完全描述了偏振态，但不包含强度信息。

琼斯矢量的一般形式可写为：
**J** = [cos θ exp(iφx)]
      [sin θ exp(iφy)]

其中 θ 决定振幅比，φx 和 φy 是相位。利用整体相位的任意性，可选择 φx = 0：

**J** = [cos θ]
      [sin θ exp(iδ)]

这里 δ = φy - φx 是相位差。

### 22.2.2 基本偏振态的琼斯表示

**水平线偏振（H）**：
**J**H = [1]
       [0]

**垂直线偏振（V）**：
**J**V = [0]
       [1]

**45° 线偏振（D）**：
**J**D = (1/√2)[1]
              [1]

**-45° 线偏振（A）**：
**J**A = (1/√2)[1]
              [-1]

**右旋圆偏振（R）**：
**J**R = (1/√2)[1]
              [-i]

**左旋圆偏振（L）**：
**J**L = (1/√2)[1]
              [i]

这六个状态构成三组正交基：{H,V}、{D,A}、{R,L}。任意偏振态可在任一组基下展开。

### 22.2.3 琼斯矩阵方法

偏振器件对琼斯矢量的作用可用 2×2 复矩阵表示：

**J**out = **M** **J**in

其中 **M** 是琼斯矩阵。对于无损器件，矩阵应满足幺正性：**M**†**M** = **I**。

**基本琼斯矩阵**：

线偏振器（透振方向与 x 轴夹角 θ）：
**M**pol(θ) = [cos²θ      cos θ sin θ]
             [cos θ sin θ  sin²θ     ]

相位延迟器（快轴沿 x，相位延迟 δ）：
**M**ret(δ) = [1    0      ]
             [0    exp(iδ)]

旋转器（旋转角 θ）：
**M**rot(θ) = [cos θ  -sin θ]
             [sin θ   cos θ]

### 22.2.4 级联系统的矩阵运算

多个器件级联时，总的琼斯矩阵为各矩阵的乘积（注意顺序）：

**M**total = **M**n **M**n-1 ... **M**2 **M**1

**例：四分之一波片 + 线偏振器**

设四分之一波片快轴沿 x（δ = π/2），后接水平偏振器：

**M**total = **M**pol(0) **M**ret(π/2) = [1 0][1  0 ] = [1 0]
                                        [0 0][0  i ]   [0 0]

输入右旋圆偏振光：
**J**out = **M**total **J**R = [1 0](1/√2)[1 ] = (1/√2)[1]
                              [0 0]      [-i]         [0]

输出为水平线偏振光，强度减半。

**任意取向相位延迟器的矩阵**：

快轴与 x 轴夹角为 θ 的相位延迟器：
**M**(θ,δ) = **R**(-θ) **M**ret(δ) **R**(θ)

展开得：
**M**(θ,δ) = [cos²θ + sin²θ exp(iδ)        sin θ cos θ(1 - exp(iδ))]
             [sin θ cos θ(1 - exp(iδ))    sin²θ + cos²θ exp(iδ)    ]

这个公式在分析复杂偏振系统时非常有用。

### 22.2.5 琼斯演算的应用实例

**偏振态转换设计**：

问题：设计一个系统将水平线偏振转换为左旋圆偏振。

解：需要找到矩阵 **M** 使得：
**M**[1, 0]ᵀ = (1/√2)[1, i]ᵀ

一种解决方案：45°取向的四分之一波片
**M** = **R**(-π/4)**M**ret(π/2)**R**(π/4) = (1/√2)[1+i  1-i]
                                                    [1-i  1+i]

验证：**M**[1, 0]ᵀ = (1/√2)[(1+i), (1-i)]ᵀ = (1/√2)[1, i]ᵀ exp(iπ/4)

相位因子不影响偏振态。

**偏振模式转换器**：

光纤通信中常需要在TE和TM模式间转换。使用半波片：

TE→TM：**M**HWP(π/4) = [0  1]
                       [1  0]

这实现了x和y分量的交换。

**消偏振器设计**：

理想消偏振器将任意输入偏振态转换为非偏振光。但琼斯矩阵无法描述这一过程，需要使用Mueller矩阵。

伪消偏振器（Lyot消偏振器）：
- 两个延迟量不同的波片级联
- δ₁ = 2π，δ₂ = π
- 对窄带光源产生快速变化的输出偏振态

### 22.2.6 琼斯矩阵的数学性质

**特征值与特征矢量**：

任意琼斯矩阵 **M** 的特征方程：
det(**M** - λ**I**) = 0

特征矢量代表不变偏振态（eigenpolarizations）。

例：四分之一波片（快轴0°）
特征值：λ₁ = 1, λ₂ = i
特征矢量：**v**₁ = [1, 0]ᵀ（水平偏振），**v**₂ = [0, 1]ᵀ（垂直偏振）

**矩阵分解**：

任意琼斯矩阵可分解为：
**M** = **U**Λ**U**†

其中 **U** 是幺正矩阵，Λ 是对角矩阵。

物理意义：
1. **U**†：转换到特征偏振基
2. Λ：在特征基下的相位延迟
3. **U**：转换回原始基

**群论性质**：

无损偏振器件的琼斯矩阵构成SU(2)群：
- 行列式为1（能量守恒）
- 幺正性（可逆过程）
- 群运算：矩阵乘法

SU(2)的生成元（Pauli矩阵）：
σ₁ = [0 1]    σ₂ = [0 -i]    σ₃ = [1  0]
     [1 0]         [i  0]          [0 -1]

任意SU(2)元素：
**M** = exp(i**n**·**σ**θ/2) = cos(θ/2)**I** + i sin(θ/2)**n**·**σ**

这与量子力学中的旋转算符同构。

## 22.3 斯托克斯参数

### 22.3.1 斯托克斯参数的定义

斯托克斯参数提供了描述任意偏振态（包括部分偏振光）的完整方法。定义四个实参数：

S₀ = ⟨|Ex|²⟩ + ⟨|Ey|²⟩ = I（总强度）
S₁ = ⟨|Ex|²⟩ - ⟨|Ey|²⟩
S₂ = 2⟨Ex*Ey⟩ᴿ = 2⟨|Ex||Ey|cos δ⟩
S₃ = 2⟨Ex*Ey⟩ᴵ = 2⟨|Ex||Ey|sin δ⟩

其中 ⟨·⟩ 表示时间平均或统计平均。斯托克斯矢量定义为：

**S** = [S₀]
      [S₁]
      [S₂]
      [S₃]

对于完全偏振光，有约束条件：
S₀² = S₁² + S₂² + S₃²

### 22.3.2 部分偏振光的描述

部分偏振光可分解为完全偏振部分和完全非偏振部分：

**S** = **S**pol + **S**unpol

其中：
**S**unpol = [S₀ - √(S₁² + S₂² + S₃²)]
            [0]
            [0]
            [0]

**S**pol = [√(S₁² + S₂² + S₃²)]
          [S₁]
          [S₂]
          [S₃]

偏振度定义为：
P = √(S₁² + S₂² + S₃²) / S₀

满足 0 ≤ P ≤ 1，其中 P = 0 表示完全非偏振光，P = 1 表示完全偏振光。

### 22.3.3 偏振度的计算

**与相干性的关系**：

对于准单色光，偏振度与相干度密切相关：

P² = (S₁² + S₂² + S₃²) / S₀² = 4|⟨Ex*Ey⟩|² / (⟨|Ex|²⟩ + ⟨|Ey|²⟩)²

当 Ex 和 Ey 完全相干时，P = 1；完全不相干时，P = 0。

**偏振态参数的提取**：

从斯托克斯参数可提取偏振椭圆的参数：

方位角：ψ = (1/2)arctan(S₂/S₁)
椭圆率角：χ = (1/2)arcsin(S₃/√(S₁² + S₂² + S₃²))

对于部分偏振光，这些参数描述其偏振部分的性质。

### 22.3.4 测量方法

斯托克斯参数可通过一系列强度测量获得：

**基本测量方案**：

S₀ = IH + IV（水平 + 垂直偏振器）
S₁ = IH - IV
S₂ = ID - IA（+45° 和 -45° 偏振器）
S₃ = IR - IL（右旋和左旋圆偏振分析器）

其中圆偏振分析器由四分之一波片加线偏振器组成。

**矩阵表示**：

测量可表示为：
I = (1/2)**a**ᵀ**S**

其中 **a** 是分析器矢量。例如：
- 水平偏振器：**a**H = [1, 1, 0, 0]ᵀ
- 右旋圆偏振分析器：**a**R = [1, 0, 0, 1]ᵀ

**Mueller 矩阵**：

斯托克斯矢量通过光学元件的变换用 4×4 Mueller 矩阵描述：

**S**out = **M** **S**in

Mueller 矩阵包含了器件的全部偏振特性，包括偏振相关损耗和去偏振效应。

常见器件的 Mueller 矩阵：

线偏振器（水平）：
**M**pol = (1/2)[1  1  0  0]
               [1  1  0  0]
               [0  0  0  0]
               [0  0  0  0]

四分之一波片（快轴水平）：
**M**QWP = [1  0  0  0]
          [0  1  0  0]
          [0  0  0  1]
          [0  0 -1  0]

### 22.3.5 Mueller矩阵的深入分析

**Mueller矩阵的约束条件**：

物理可实现的Mueller矩阵必须满足：

1. **正定性约束**：
   对任意输入Stokes矢量 **S**in（满足S₀² ≥ S₁² + S₂² + S₃²），
   输出 **S**out = **M****S**in 也必须满足相同约束。

2. **特征值约束**：
   相干矩阵 **C** = **M**ᵀ**M** 的特征值必须非负。

3. **Cloude分解**：
   任意Mueller矩阵可分解为：
   **M** = Σᵢ pᵢ**M**ᵢ
   其中 pᵢ ≥ 0，Σpᵢ = 1，**M**ᵢ 是非去偏振Mueller矩阵。

**去偏振度的量化**：

Mueller矩阵的去偏振能力可用多个指标描述：

1. **去偏振指数**：
   DI = √(Σᵢ,ⱼ≠00 M²ᵢⱼ)/√(3M²₀₀)

2. **偏振纯度指数**：
   P₁ = |**m**₁|/m₀₀（第一列）
   P₂ = |**m**ᵀ|/m₀₀（第一行）
   
   其中 **m**₁ = [M₁₀, M₂₀, M₃₀]ᵀ

3. **平均去偏振度**：
   Δ = 1 - (P₁ + P₂)/2

**Mueller-Jones对应**：

对于非去偏振系统，Mueller矩阵与Jones矩阵的关系：

**M** = **A**(**J** ⊗ **J***)**A**⁻¹

其中 ⊗ 是Kronecker积，**A** 是变换矩阵：

**A** = [1  0   0   1]
       [1  0   0  -1]
       [0  1   1   0]
       [0  i  -i   0]

逆变换：
**A**⁻¹ = (1/2)[1  1   0   0]
               [0  0   1  -i]
               [0  0   1   i]
               [1 -1   0   0]

### 22.3.6 偏振态的统计描述

**相干矩阵表示**：

对于部分偏振光，引入2×2相干矩阵：

**Φ** = ⟨**E****E**†⟩ = [⟨|Ex|²⟩     ⟨Ex*Ey⟩]
                      [⟨ExEy*⟩     ⟨|Ey|²⟩]

与Stokes参数的关系：
**Φ** = (1/2)[S₀ + S₁    S₂ - iS₃]
             [S₂ + iS₃   S₀ - S₁]

相干矩阵性质：
- Hermitian：**Φ** = **Φ**†
- 半正定：特征值 λ₁, λ₂ ≥ 0
- 迹：Tr(**Φ**) = S₀（总强度）

**偏振熵**：

类比信息论，定义偏振熵：

H = -Σᵢ (λᵢ/S₀)log₂(λᵢ/S₀)

其中 λᵢ 是相干矩阵的特征值。

- H = 0：完全偏振光（纯态）
- H = 1：完全非偏振光（最大混合态）

**偏振态的概率解释**：

部分偏振光可视为不同偏振态的统计混合：

**Φ** = Σᵢ pᵢ|**E**ᵢ⟩⟨**E**ᵢ|

其中 pᵢ 是第i个偏振态的概率权重。

这与量子力学的密度矩阵形式完全类似。

## 22.4 庞加莱球表示

### 22.4.1 球面几何与偏振态

庞加莱球（Poincaré sphere）提供了偏振态的优雅几何表示，将所有可能的偏振态映射到单位球面上。这种表示不仅直观，而且揭示了偏振态之间的深层几何关系。

**球面坐标与斯托克斯参数**：

对于完全偏振光，归一化斯托克斯参数满足：
s₁² + s₂² + s₃² = 1

其中 sᵢ = Sᵢ/S₀（i = 1,2,3）。这定义了三维空间中的单位球面。

球面上每点的笛卡尔坐标直接对应归一化斯托克斯参数：
- x = s₁ = cos 2χ cos 2ψ
- y = s₂ = cos 2χ sin 2ψ  
- z = s₃ = sin 2χ

其中 ψ 是偏振椭圆的方位角，χ 是椭圆率角。

**球面坐标表示**：

使用球坐标 (θ, φ)：
- 极角 θ ∈ [0, π]：θ = π/2 - 2χ
- 方位角 φ ∈ [0, 2π]：φ = 2ψ

斯托克斯参数的球坐标形式：
s₁ = sin θ cos φ
s₂ = sin θ sin φ
s₃ = cos θ

**特殊偏振态的位置**：

- 赤道（θ = π/2）：所有线偏振态
  - H态：(1,0,0)，φ = 0
  - V态：(-1,0,0)，φ = π
  - D态：(0,1,0)，φ = π/2
  - A态：(0,-1,0)，φ = 3π/2

- 极点：圆偏振态
  - 北极 L态：(0,0,1)，左旋圆偏振
  - 南极 R态：(0,0,-1)，右旋圆偏振

- 一般位置：椭圆偏振态
  - 北半球：左旋椭圆偏振
  - 南半球：右旋椭圆偏振

### 22.4.2 偏振态的球面映射

**从琼斯矢量到庞加莱球**：

给定归一化琼斯矢量 **J** = [a, b]ᵀ，其中 |a|² + |b|² = 1，对应的球面坐标为：

s₁ = |a|² - |b|² = 2|a||b|cos(arg(b) - arg(a))
s₂ = 2Re(a*b) = 2|a||b|cos(arg(b/a))
s₃ = 2Im(a*b) = 2|a||b|sin(arg(b/a))

**立体投影表示**：

庞加莱球可通过立体投影映射到复平面。从南极向北投影：

ζ = (s₁ + is₂)/(1 + s₃) = tan(θ/2)exp(iφ)

这个复数 ζ 完全确定了偏振态。对于琼斯矢量 [a,b]ᵀ，有：
ζ = b/a

这建立了琼斯矢量复数比与庞加莱球的直接联系。

**对径点的物理意义**：

球面上的对径点表示正交偏振态：
- 若 **S** 和 **S'** 是对径点，则对应的偏振态正交
- **S'** = -**S**
- 正交性：⟨**J**|**J'**⟩ = 0

这个性质在偏振分析和量子信息中非常重要。

**大圆的意义**：

通过球心的平面与球面的交线形成大圆。任意大圆上的点构成一组特殊的偏振态家族：
- 赤道大圆：所有线偏振态
- 经线大圆：固定椭圆率，变化方位角
- 一般大圆：表示可由两个正交态线性叠加得到的所有态

### 22.4.3 偏振态演化的几何描述

**相位延迟器的作用**：

相位延迟器在庞加莱球上的作用是绕某轴的旋转。设延迟器快轴方向为 α，相位延迟 δ：

旋转轴：**n** = [cos 2α, sin 2α, 0]ᵀ
旋转角：δ

旋转矩阵（Rodrigues公式）：
**R**(δ,**n**) = **I** + sin δ [**n**]× + (1-cos δ)[**n**]×²

其中 [**n**]× 是反对称矩阵：
[**n**]× = [ 0      0     -sin 2α]
         [ 0      0      cos 2α]
         [sin 2α -cos 2α    0   ]

**特殊情况**：

1. 半波片（δ = π）：绕快轴方向旋转 180°
   - 保持与快轴平行的线偏振态不变
   - 反转垂直于快轴的偏振分量

2. 四分之一波片（δ = π/2）：绕快轴方向旋转 90°
   - 将与快轴成 45° 的线偏振转为圆偏振
   - 将圆偏振转为线偏振

**偏振态序列的几何轨迹**：

连续变化的偏振器件产生的偏振态在庞加莱球上描绘连续轨迹：

1. 旋转线偏振器：轨迹为赤道上的点
2. 可变延迟器：轨迹为通过固定轴的大圆弧
3. 旋光器：轨迹为绕 z 轴的纬线圆

**偏振模色散（PMD）的几何描述**：

在光纤中，偏振态演化可表示为庞加莱球上的随机游走：
d**s**/dz = **Ω**(z) × **s**

其中 **Ω**(z) 是局部双折射矢量。这导致：
- 短距离：确定性旋转
- 长距离：扩散行为
- 相关长度：定义偏振保持能力

### 22.4.4 与量子比特的类比

庞加莱球与量子力学中的布洛赫球（Bloch sphere）在数学上同构，这揭示了经典偏振光学与量子信息的深刻联系。

**量子态的对应**：

量子比特态：|ψ⟩ = α|0⟩ + β|1⟩，其中 |α|² + |β|² = 1

对应的布洛赫矢量：
**r** = [2Re(α*β), 2Im(α*β), |α|² - |β|²]ᵀ

与偏振态的对应：
- |0⟩ ↔ 水平偏振 |H⟩
- |1⟩ ↔ 垂直偏振 |V⟩
- (|0⟩ + |1⟩)/√2 ↔ 45°偏振 |D⟩
- (|0⟩ + i|1⟩)/√2 ↔ 左旋圆偏振 |L⟩

**泡利矩阵与斯托克斯参数**：

密度矩阵表示：
ρ = (1/2)(σ₀ + s₁σ₁ + s₂σ₂ + s₃σ₃)

其中 σᵢ 是泡利矩阵：
σ₁ = [0 1]    σ₂ = [0 -i]    σ₃ = [1  0]
     [1 0]         [i  0]          [0 -1]

这建立了斯托克斯参数与量子力学密度矩阵的直接联系。

**幺正变换与偏振变换**：

量子门操作 U 对应偏振变换：
|ψ'⟩ = U|ψ⟩ ↔ **J'** = **U****J**

在布洛赫球上，这表现为旋转：
**r'** = **R****r**

其中旋转矩阵 **R** 与幺正矩阵 U 通过如下关系联系：
U = exp(-iθ**n**·**σ**/2) ↔ **R** = exp(-θ[**n**]×)

**应用实例**：

1. **量子密钥分发（QKD）**：
   - BB84协议使用两组正交偏振基
   - 在庞加莱球上对应两组对径点

2. **量子态层析**：
   - 通过偏振测量重构量子态
   - 对应庞加莱球上的态重构

3. **几何相位（Berry相位）**：
   - 偏振态在参数空间闭合路径的相位
   - 等于庞加莱球上对应路径所围立体角的一半

## 22.5 偏振器件的矩阵描述

### 22.5.1 线偏振器

线偏振器是最基本的偏振器件，只允许特定方向的线偏振分量通过。理想线偏振器可用琼斯矩阵和Mueller矩阵完整描述。

**理想线偏振器的琼斯矩阵**：

透振方向与x轴夹角为θ的线偏振器：

**P**(θ) = [cos²θ      cos θ sin θ]
          [cos θ sin θ  sin²θ     ]

这可以分解为：
**P**(θ) = **p̂****p̂**†

其中 **p̂** = [cos θ, sin θ]ᵀ 是透振方向的单位矢量。

**特殊角度的偏振器**：

水平偏振器（θ = 0）：
**P**H = [1 0]
        [0 0]

垂直偏振器（θ = π/2）：
**P**V = [0 0]
        [0 1]

45°偏振器（θ = π/4）：
**P**D = (1/2)[1 1]
             [1 1]

**消光比和非理想性**：

实际偏振器存在有限消光比 ε：

**P**real(θ) = [cos²θ + ε sin²θ     (1-ε)cos θ sin θ]
              [(1-ε)cos θ sin θ    sin²θ + ε cos²θ ]

消光比定义：ER = 10 log₁₀(1/ε) dB

典型值：
- 薄膜偏振器：20-30 dB
- 晶体偏振器：40-60 dB
- 纳米线栅偏振器：>40 dB

**Mueller矩阵表示**：

理想线偏振器的Mueller矩阵：

**M**pol(θ) = (1/2)[1 + cos 2θ    sin 2θ      0  0]
                   [cos 2θ    cos² 2θ   sin 2θ cos 2θ  0]
                   [sin 2θ   sin 2θ cos 2θ   sin² 2θ    0]
                   [0           0           0        0]

注意最后一行全零，表示完全去偏振化。

**偏振器的物理实现**：

1. **二向色性材料**（如Polaroid）：
   - 基于各向异性吸收
   - 宽带工作，但损耗较大
   
2. **双折射晶体**（如方解石）：
   - 利用o光和e光分离
   - 高消光比，窄带工作
   
3. **布儒斯特角反射**：
   - p偏振无反射
   - 消光比依赖入射角精度

4. **金属线栅**：
   - 亚波长周期结构
   - 宽带、高功率承受能力

### 22.5.2 相位延迟器

相位延迟器（波片）在两个正交偏振分量间引入相位差，是偏振控制的核心器件。

**一般相位延迟器的琼斯矩阵**：

快轴沿x轴，相位延迟δ：

**R**₀(δ) = [1      0     ]
           [0   exp(iδ)]

快轴与x轴夹角θ的一般延迟器：

**R**(θ,δ) = **T**(-θ)**R**₀(δ)**T**(θ)

展开得：
**R**(θ,δ) = [cos²θ + sin²θ e^(iδ)      sin θ cos θ(1 - e^(iδ))]
            [sin θ cos θ(1 - e^(iδ))   sin²θ + cos²θ e^(iδ)   ]

其中旋转矩阵：
**T**(θ) = [cos θ  -sin θ]
          [sin θ   cos θ]

**常用波片**：

1. **四分之一波片（QWP）**，δ = π/2：
   
   **R**QWP(θ) = [cos²θ + i sin²θ     (1-i)sin θ cos θ]
                [(1-i)sin θ cos θ    sin²θ + i cos²θ ]
   
   特殊取向：
   - θ = 0：**R**QWP = diag(1, i)
   - θ = 45°：线偏振↔圆偏振转换器

2. **半波片（HWP）**，δ = π：
   
   **R**HWP(θ) = [cos 2θ   sin 2θ]
                [sin 2θ  -cos 2θ]
   
   作用：将偏振方向旋转2θ

3. **全波片（FWP）**，δ = 2π：
   
   **R**FWP = **I**（恒等变换）
   
   用于补偿和相位调节

**色散与温度效应**：

实际波片的相位延迟依赖波长和温度：

δ(λ,T) = 2π(nₑ - nₒ)d/λ + α(T - T₀)

其中：
- (nₑ - nₒ)：双折射率差
- d：晶体厚度
- α：温度系数

**零级、多级和复合波片**：

1. **零级波片**：δ = δ₀（单片，很薄）
   - 优点：色散小
   - 缺点：机械脆弱

2. **多级波片**：δ = 2πm + δ₀
   - 优点：机械强度好
   - 缺点：色散大，温度敏感

3. **复合波片**：两片相减
   δ = δ₁ - δ₂ = δ₀
   - 平衡了色散和强度

**Mueller矩阵表示**：

相位延迟器的Mueller矩阵：

**M**ret(θ,δ) = [1        0                    0                   0       ]
                [0   cos²2θ+sin²2θ cos δ   sin 2θ cos 2θ(1-cos δ)  -sin 2θ sin δ]
                [0   sin 2θ cos 2θ(1-cos δ)  sin²2θ+cos²2θ cos δ    cos 2θ sin δ]
                [0       sin 2θ sin δ          -cos 2θ sin δ          cos δ    ]

### 22.5.3 旋光器

旋光器旋转线偏振光的偏振方向，而不改变偏振态的其他性质。这种效应源于圆双折射。

**旋光的物理机制**：

1. **自然旋光性**（石英、糖溶液）：
   - 分子手性导致
   - 旋转角：α = πΔn·d/λ
   - Δn = nL - nR（左右圆偏振折射率差）

2. **法拉第旋光**（磁光效应）：
   - 外加磁场诱导
   - 旋转角：α = V·B·d
   - V：Verdet常数

**琼斯矩阵表示**：

旋光角为α的旋光器：

**O**(α) = [cos α  -sin α]
          [sin α   cos α]

这与坐标旋转矩阵相同，但物理意义不同：
- 坐标旋转：观察者视角改变
- 旋光：偏振态实际旋转

**旋光器的重要性质**：

1. **非互易性**（法拉第旋光）：
   - 正向传播：旋转+α
   - 反向传播：再旋转+α（而非-α）
   - 总旋转：2α

2. **互易性**（自然旋光）：
   - 正向：+α
   - 反向：-α
   - 往返后无净旋转

**旋光器与波片的组合**：

旋光器可由圆偏振基下的相位延迟实现：

**O**(α) = **T**cir **R**₀(2α) **T**†cir

其中 **T**cir 是从线偏振基到圆偏振基的变换：

**T**cir = (1/√2)[1   1]
                 [i  -i]

**Mueller矩阵**：

**M**rot(α) = [1    0       0      0]
             [0  cos 2α  -sin 2α  0]
             [0  sin 2α   cos 2α  0]
             [0    0       0      1]

在庞加莱球上表现为绕S₃轴（z轴）旋转2α。

### 22.5.4 复合器件系统

实际偏振系统由多个器件级联构成。理解其综合效应需要矩阵运算和系统分析。

**级联系统的矩阵描述**：

N个器件级联：
- 琼斯矩阵：**J**total = **J**N···**J**₂**J**₁
- Mueller矩阵：**M**total = **M**N···**M**₂**M**₁

注意顺序：光先通过器件1，最后通过器件N。

**偏振补偿器设计**：

**Babinet-Soleil补偿器**：
- 两个楔形波片，相对滑动
- 连续可调相位延迟：δ = k(d₁ - d₂)
- 矩阵：**R**(θ, δ(d))

**Berek补偿器**：
- 倾斜波片
- 延迟量：δ = δ₀/cos φ（φ为倾斜角）
- 同时改变延迟量和快轴方向

**偏振控制器**：

标准三片式控制器（QWP-HWP-QWP）：

**P**total = **R**QWP(θ₃)**R**HWP(θ₂)**R**QWP(θ₁)

可实现任意偏振态变换（SU(2)群的任意元素）。

参数与庞加莱球旋转的关系：
- θ₁：绕S₁轴旋转
- θ₂：绕变换后的S₃轴旋转
- θ₃：绕最终S₁轴旋转

**偏振分析器设计**：

**完整Stokes偏振计**：

需要至少4次测量。典型配置：
1. I₀°：水平偏振器
2. I₉₀°：垂直偏振器
3. I₄₅°：45°偏振器
4. IRCP：QWP + 水平偏振器

Stokes参数：
S₀ = I₀° + I₉₀°
S₁ = I₀° - I₉₀°
S₂ = 2I₄₅° - S₀
S₃ = 2IRCP - S₀

**旋转波片偏振计**：

连续旋转QWP，固定偏振器：
I(ω₁t) = (1/2)[S₀ + S₁cos(4ω₁t) + S₂sin(4ω₁t)cos δ - S₃sin(4ω₁t)sin δ]

傅里叶分析提取Stokes参数。

**矩阵条件数与误差传播**：

器件组合的数值稳定性：
κ(**M**) = ||**M**|| · ||**M**⁻¹||

条件数大表示对输入扰动敏感。优化设计应最小化条件数。

误差传播：
δ**S**out ≈ **M** δ**S**in + δ**M** **S**in

需要考虑：
- 器件制造公差
- 对准误差
- 波长依赖性
- 温度漂移

### 22.5.5 实用偏振测量与应用

偏振测量技术在科学研究和工业应用中扮演着重要角色。本节探讨实际偏振测量系统的设计原理及其在各领域的应用。

**高精度偏振测量**：

**双旋转延迟器偏振计**：

最精确的偏振测量方法之一，使用两个同步旋转的延迟器：

探测强度：
I(t) = a₀ + Σₙ₌₁⁴ [aₙcos(nω₁t) + bₙsin(nω₁t)] + Σₘ₌₁⁴ [cₘcos(mω₂t) + dₘsin(mω₂t)]

其中系数与Stokes参数的关系通过傅里叶分析确定。

优势：
- 自校准能力
- 消除系统误差
- 宽光谱范围
- 精度可达 ΔP/P ~ 10⁻⁵

**分振幅偏振计**：

使用偏振分束器同时测量两个正交分量：

设计考虑：
1. 分束器消光比 > 10³:1
2. 探测器匹配：响应度差异 < 0.1%
3. 同步采集消除时间变化

校准矩阵：
**A** = [a₁₁ a₁₂ a₁₃ a₁₄]
       [a₂₁ a₂₂ a₂₃ a₂₄]
       [a₃₁ a₃₂ a₃₃ a₃₄]
       [a₄₁ a₄₂ a₄₃ a₄₄]

Stokes参数反演：
**S** = **A**⁻¹**I**

其中 **I** = [I₁, I₂, I₃, I₄]ᵀ 是四个通道的强度。

**光谱偏振测量**：

**通道光谱偏振计（Channeled Spectropolarimeter）**：

利用厚延迟器产生的光谱调制：

I(σ) = (1/2)[S₀(σ) + S₁(σ)cos(2πδ₁σ) + S₂(σ)sin(2πδ₁σ)cos θ₁ - S₃(σ)sin(2πδ₁σ)sin θ₁]

其中 σ = 1/λ 是波数，δ₁ 是延迟器厚度。

通过傅里叶变换恢复Stokes光谱：
S₀(σ) = 2∫I(σ')dσ'
S₁(σ) = 4∫I(σ')cos(2πδ₁σ')dσ'

分辨率与延迟器厚度的关系：
Δσ = 1/(2δ₁)

**成像偏振测量**：

**分焦平面偏振相机**：

微偏振器阵列集成在探测器上：
- 2×2超像素：0°, 45°, 90°, 135°
- 瞬时Stokes参数计算
- 空间分辨率降低4倍

插值算法恢复全分辨率：
S₀(x,y) = I₀° + I₉₀° + 2I_interp
S₁(x,y) = I₀° - I₉₀°
S₂(x,y) = I₄₅° - I₁₃₅°

其中 I_interp 是邻近像素插值。

**液晶可调谐偏振成像**：

使用液晶可变延迟器（LCVR）：
δ(V) = 2πΔn(V)d/λ

时序控制获取完整Stokes图像：
1. V₁ → δ = 0（参考）
2. V₂ → δ = π/2（QWP）
3. V₃ → δ = π（HWP）
4. 不同快轴角度

优势：无机械运动，快速切换（~10ms）。

**椭偏测量技术**：

**光谱椭偏仪原理**：

测量反射光偏振态变化确定材料光学常数：

反射系数比：
ρ = rₚ/rₛ = tan ψ exp(iΔ)

其中 ψ 和 Δ 是椭偏参数。

与材料参数的关系（各向同性材料）：
ρ = [(n₂² - n₁²sin²θ₁)^(1/2) - n₁cos θ₁] / [(n₂² - n₁²sin²θ₁)^(1/2) + n₁cos θ₁] × 
    [n₂²cos θ₁ - n₁(n₂² - n₁²sin²θ₁)^(1/2)] / [n₂²cos θ₁ + n₁(n₂² - n₁²sin²θ₁)^(1/2)]

多层结构需要传输矩阵方法：
**M** = ∏ᵢ **M**ᵢ

模型拟合提取：
- 层厚度
- 折射率 n(λ)
- 消光系数 k(λ)
- 表面粗糙度

**穆勒矩阵椭偏测量**：

完整16元素Mueller矩阵测量：

归一化Mueller矩阵：
**m** = **M**/M₀₀

去偏振度分析：
- 偏振纯度：Pᵤ = |**m**₁|（第一列）
- 双衰减：D = 1 - min(eigenvalues)

各向异性参数提取：
- 线性双折射：LB = |m₁₂ - m₂₁|
- 圆双折射：CB = |m₁₃ - m₃₁|
- 线性二向色性：LD' = |m₀₁ - m₁₀|

**偏振在各领域的应用**：

**遥感与大气光学**：

**气溶胶特性反演**：

Mie散射的偏振特征：
P(θ) = (|S₂(θ)|² - |S₁(θ)|²)/(|S₂(θ)|² + |S₁(θ)|²)

其中 S₁, S₂ 是散射振幅函数。

多角度偏振测量反演：
- 粒径分布 n(r)
- 复折射率 m = n + ik
- 形状因子

反演算法：
min Σᵢ [P_obs(θᵢ) - P_model(θᵢ,**p**)]²/σᵢ²

其中 **p** 是待反演参数。

**偏振雷达**：

降水粒子识别：
- 差分反射率：ZDR = 10log(Zhh/Zvv)
- 相关系数：ρhv = |⟨S*hhSvv⟩|/√(⟨|Shh|²⟩⟨|Svv|²⟩)
- 比差分相位：KDP = (ΦDP(r₂) - ΦDP(r₁))/(2(r₂-r₁))

水凝物分类：
- 雨滴：ZDR > 0.5 dB, ρhv > 0.97
- 冰雹：ZDR ~ 0 dB, ρhv < 0.95
- 融化层：ZDR峰值，ρhv下降

**生物医学成像**：

**偏振敏感OCT（PS-OCT）**：

组织双折射测量：
δ(z) = 2k₀∫₀ᶻ Δn(z')dz'

其中 Δn 是局部双折射。

从Jones矩阵提取：
**J**(z) = [√R₁₁  √R₁₂ exp(iφ₁₂)]
          [√R₂₁ exp(iφ₂₁)  √R₂₂]

相位延迟：
δ = arg(J₁₁J₂₂) - arg(J₁₂J₂₁)

快轴方向：
θ = (1/2)arctan[2Re(J₁₂J₂₁)/(|J₁₁|² - |J₂₂|²)]

临床应用：
- 视网膜神经纤维层（双折射 ~0.5°/μm）
- 动脉粥样硬化斑块表征
- 烧伤深度评估

**穆勒矩阵显微镜**：

组织病理诊断参数：
1. 线性延迟：δ = arccos[(m₂₂ + m₃₃)/2]
2. 圆二向色性：ψ = arctan(m₃₄/m₂₄)
3. 去偏振度：Δ = 1 - |det(**m**₃ₓ₃)|^(1/3)

其中 **m**₃ₓ₃ 是3×3子矩阵。

癌变组织特征：
- 去偏振度增加（散射增强）
- 双折射模式改变（胶原重组）
- 各向异性增强

**量子通信与密码学**：

**BB84协议实现**：

四态编码：
|0⟩_H = |H⟩, |1⟩_H = |V⟩（直线基）
|0⟩_D = |D⟩, |1⟩_D = |A⟩（对角基）

安全性分析：
- 量子比特错误率（QBER）：e = N_error/N_total
- 安全阈值：e < 11%（理想情况）
- 密钥率：R = 1 - h(e) - h(e)（信息论界限）

其中 h(x) = -x log₂x - (1-x)log₂(1-x) 是二元熵函数。

**连续变量QKD**：

使用偏振调制的相干态：
|α⟩_H + |β⟩_V

协方差矩阵：
**V** = [⟨ΔX²⟩   ⟨ΔXΔP⟩]
       [⟨ΔPΔX⟩  ⟨ΔP²⟩]

安全条件（反向协调）：
I(A:B) > χ(B:E)

其中 I 是互信息，χ 是Holevo信息。

**工业检测应用**：

**光弹性应力分析**：

应力诱导双折射：
Δn = C(σ₁ - σ₂)

其中 C 是光弹性系数，σᵢ 是主应力。

等色线（恒定相位延迟）：
N = δ/(2π) = (t/λ)C(σ₁ - σ₂)

等倾线（恒定主应力方向）：
通过圆偏振光照明消除

全场应力分离：
- 六步相移法
- RGB光弹性法
- 数字图像相关

**表面检测**：

偏振散射测量缺陷：

BRDF的偏振分量：
f_pq = dL_p/(E_q dΩ cos θᵢ)

其中 p,q ∈ {s,p} 表示出射和入射偏振。

表面粗糙度参数提取：
- RMS高度：σ_h
- 相关长度：l_c
- 功率谱密度：PSD(k)

与散射的关系（Beckmann模型）：
f ∝ exp[-(4πσ_h cos θᵢ/λ)²]

缺陷分类：
- 划痕：强各向异性散射
- 颗粒污染：去偏振增强
- 膜层缺陷：偏振对比度异常

**先进偏振技术展望**：

**超表面偏振器件**：

亚波长结构实现任意偏振变换：
- 几何相位（Pancharatnam-Berry相位）
- 传播相位调控
- 局部偏振转换

设计原理：
**J**_out = **T**(x,y)**J**_in

其中 **T**(x,y) 是空间变化的Jones矩阵。

应用：
- 偏振全息
- 矢量光束生成
- 偏振复用通信

**量子偏振纠缠**：

双光子偏振纠缠态：
|Ψ⟩ = (1/√2)(|H⟩_A|V⟩_B - |V⟩_A|H⟩_B)

Bell不等式测试：
S = |E(a,b) - E(a,b') + E(a',b) + E(a',b')| ≤ 2（经典）
S_quantum = 2√2（量子力学预测）

其中 E(a,b) 是关联函数。

应用前景：
- 量子计算
- 量子成像
- 量子传感

## 本章小结

本章系统介绍了偏振光学的数学基础，建立了从基本概念到实际应用的完整理论体系：

1. **偏振态描述**：深入探讨了电磁波的偏振现象，建立了线偏振、圆偏振和椭圆偏振的数学描述。通过偏振椭圆的几何构造，揭示了不同偏振态之间的内在联系。

2. **琼斯矢量方法**：介绍了完全偏振光的复振幅表示，建立了琼斯矩阵演算体系。通过矩阵运算描述偏振器件的作用，为偏振系统设计提供了强大工具。重要公式包括：
   - 琼斯矢量：**J** = [Ex₀, Ey₀]ᵀ
   - 器件作用：**J**_out = **M****J**_in
   - 级联系统：**M**_total = **M**_n···**M**₂**M**₁

3. **斯托克斯参数**：扩展到部分偏振光的描述，定义了四个实参数 S₀, S₁, S₂, S₃。建立了偏振度概念 P = √(S₁² + S₂² + S₃²)/S₀，连接了偏振与相干性。Mueller矩阵方法允许描述去偏振效应。

4. **庞加莱球表示**：将所有偏振态映射到单位球面，提供了偏振态演化的直观几何图像。揭示了与量子比特的深刻类比，建立了经典偏振光学与量子信息的桥梁。关键关系：
   - 球面坐标：(s₁, s₂, s₃) = (cos 2χ cos 2ψ, cos 2χ sin 2ψ, sin 2χ)
   - 偏振变换：球面旋转
   - 正交态：对径点

5. **偏振器件矩阵**：详细推导了线偏振器、相位延迟器、旋光器的琼斯矩阵和Mueller矩阵。探讨了实际器件的非理想性，如有限消光比、色散效应等。复合系统设计原则强调了矩阵运算顺序的重要性。

6. **实用测量与应用**：从高精度偏振测量技术到各领域应用，展示了偏振光学的广泛影响。涵盖遥感、生物医学成像、量子通信、工业检测等前沿应用，突出了偏振作为信息载体的独特优势。

本章建立的数学框架为后续章节的偏振渲染奠定了坚实基础，特别是Mueller矩阵方法将直接应用于描述材料的偏振散射特性。

## 练习题

### 基础题

**练习22.1** 证明任意偏振态可以分解为两个圆偏振态的叠加。
*提示*：使用圆偏振基 {|R⟩, |L⟩}，其中 |R⟩ = (1/√2)[1, -i]ᵀ，|L⟩ = (1/√2)[1, i]ᵀ。

<details>
<summary>答案</summary>

任意归一化琼斯矢量 **J** = [a, b]ᵀ，其中 |a|² + |b|² = 1。

定义圆偏振基：
|R⟩ = (1/√2)[1, -i]ᵀ，|L⟩ = (1/√2)[1, i]ᵀ

验证正交性：⟨R|L⟩ = (1/2)(1 - i²) = 1 ✓

展开系数：
αR = ⟨R|J⟩ = (1/√2)(a* + ib*)
αL = ⟨L|J⟩ = (1/√2)(a* - ib*)

验证：
αR|R⟩ + αL|L⟩ = (1/2)[(a* + ib*)[1, -i]ᵀ + (a* - ib*)[1, i]ᵀ]
              = (1/2)[2a*, -ia* - ib* + ia* - ib*]ᵀ
              = [a, b]ᵀ = **J** ✓

物理意义：任意偏振光可视为左旋和右旋圆偏振光的相干叠加。
</details>

**练习22.2** 一束线偏振光通过两个偏振器，第一个偏振器透振方向与入射光偏振方向夹角30°，第二个与第一个夹角60°。计算最终透射光强度（初始光强为I₀）。
*提示*：使用Malus定律或琼斯矩阵方法。

<details>
<summary>答案</summary>

方法1：Malus定律
第一个偏振器后：I₁ = I₀cos²(30°) = I₀(√3/2)² = 3I₀/4
第二个偏振器后：I₂ = I₁cos²(60°) = (3I₀/4)(1/2)² = 3I₀/16

方法2：琼斯矩阵
设入射光沿x方向偏振：**J**in = [1, 0]ᵀ

第一个偏振器（30°）：
**P**₁ = [cos²30°    cos30°sin30°] = [3/4    √3/4]
        [cos30°sin30°  sin²30°   ]   [√3/4    1/4]

第二个偏振器（90°）：
**P**₂ = [cos²90°    cos90°sin90°] = [1/4    √3/4]
        [cos90°sin90°  sin²90°   ]   [√3/4    3/4]

总矩阵：**M** = **P**₂**P**₁ = [3/8    3√3/16]
                              [3√3/16  3/8  ]

输出：**J**out = **M**[1, 0]ᵀ = [3/8, 3√3/16]ᵀ

强度：I = |Jx|² + |Jy|² = 9/64 + 27/256 = 3/16 I₀ ✓
</details>

**练习22.3** 推导斯托克斯参数与偏振椭圆参数（方位角ψ，椭圆率角χ）之间的关系。
*提示*：从电场分量的参数表示开始。

<details>
<summary>答案</summary>

设归一化电场：
Ex = cos θ
Ey = sin θ exp(iδ)

其中 θ 决定振幅比，δ 是相位差。

偏振椭圆参数与(θ,δ)的关系：
tan 2ψ = tan 2θ cos δ
sin 2χ = sin 2θ sin δ

计算斯托克斯参数：
S₀ = |Ex|² + |Ey|² = cos²θ + sin²θ = 1（归一化）
S₁ = |Ex|² - |Ey|² = cos²θ - sin²θ = cos 2θ
S₂ = 2Re(Ex*Ey) = 2cos θ sin θ cos δ = sin 2θ cos δ
S₃ = 2Im(Ex*Ey) = 2cos θ sin θ sin δ = sin 2θ sin δ

从上述关系解出：
cos 2θ = S₁
sin 2θ cos δ = S₂
sin 2θ sin δ = S₃

因此：
tan 2ψ = S₂/S₁
sin 2χ = S₃/√(S₁² + S₂² + S₃²) = S₃（完全偏振光）

反解：
S₁ = cos 2χ cos 2ψ
S₂ = cos 2χ sin 2ψ
S₃ = sin 2χ
</details>

### 挑战题

**练习22.4** 设计一个偏振系统，将任意输入偏振态转换为预定的输出偏振态。给出所需器件的最少数量和参数。
*提示*：考虑SU(2)群的生成元数量。

<details>
<summary>答案</summary>

理论基础：任意偏振变换属于SU(2)群，需要3个独立参数。

最小系统：两个可旋转的延迟器
1. 第一个延迟器：相位延迟δ₁，快轴角度θ₁
2. 第二个延迟器：相位延迟δ₂，快轴角度θ₂

总共4个参数，但由于整体相位任意，实际3个自由度。

通用解：QWP-HWP-QWP组合
**M** = **R**QWP(θ₃)**R**HWP(θ₂)**R**QWP(θ₁)

参数确定步骤：
1. 将输入态**J**in转到庞加莱球坐标(θin, φin)
2. 将输出态**J**out转到球坐标(θout, φout)
3. 计算所需旋转：
   - 先绕x轴转θ₁角
   - 再绕新z轴转θ₂角
   - 最后绕新x轴转θ₃角

数学表达：
θ₁ = arctan[sin(θout - θin)/(1 - cos(θout - θin)cos(φout - φin))]
θ₂ = φout - φin
θ₃ = arctan[sin(θout - θin)/(cos(θout - θin) - cos(φout - φin))]

特殊情况优化：
- 线偏振→线偏振：单个HWP
- 线偏振→圆偏振：单个QWP
- 相位调节：单个延迟器
</details>

**练习22.5** 证明部分偏振光的偏振度P与相干矩阵的特征值λ₁、λ₂的关系为：P = |λ₁ - λ₂|/(λ₁ + λ₂)。
*提示*：使用相干矩阵的迹和行列式。

<details>
<summary>答案</summary>

相干矩阵：
**Φ** = [⟨|Ex|²⟩     ⟨Ex*Ey⟩]
       [⟨ExEy*⟩     ⟨|Ey|²⟩]

与斯托克斯参数关系：
**Φ** = (1/2)[S₀ + S₁    S₂ - iS₃]
             [S₂ + iS₃   S₀ - S₁]

计算不变量：
Tr(**Φ**) = λ₁ + λ₂ = S₀
det(**Φ**) = λ₁λ₂ = (1/4)[S₀² - S₁² - S₂² - S₃²]

特征方程：
λ² - S₀λ + (1/4)[S₀² - S₁² - S₂² - S₃²] = 0

解得：
λ₁,₂ = (S₀/2) ± (1/2)√(S₁² + S₂² + S₃²)

因此：
λ₁ - λ₂ = √(S₁² + S₂² + S₃²)
λ₁ + λ₂ = S₀

偏振度：
P = √(S₁² + S₂² + S₃²)/S₀ = |λ₁ - λ₂|/(λ₁ + λ₂) ✓

物理意义：
- λ₁ = λ₂：完全非偏振（P = 0）
- λ₂ = 0：完全偏振（P = 1）
- 一般情况：P反映两特征值的相对差异
</details>

**练习22.6** 推导通过散射介质后偏振度退化的表达式。假设介质引入随机相位延迟δ，其概率分布为p(δ)。
*提示*：计算期望值⟨exp(iδ)⟩。

<details>
<summary>答案</summary>

初始偏振态：**J**₀ = [a, b]ᵀ

通过随机延迟器后：
**J**(δ) = [a, b exp(iδ)]ᵀ

计算相干矩阵元素：
Φ₁₁ = ⟨|a|²⟩ = |a|²（不变）
Φ₂₂ = ⟨|b|²⟩ = |b|²（不变）
Φ₁₂ = ⟨ab* exp(iδ)⟩ = ab*⟨exp(iδ)⟩
Φ₂₁ = ⟨a*b exp(-iδ)⟩ = a*b⟨exp(-iδ)⟩

关键：计算特征函数
χ(1) = ⟨exp(iδ)⟩ = ∫p(δ)exp(iδ)dδ

常见分布：
1. 均匀分布 p(δ) = 1/(2π)，δ ∈ [0, 2π]：
   χ(1) = 0 → 完全去偏振

2. 高斯分布 p(δ) = (1/√(2πσ²))exp(-δ²/2σ²)：
   χ(1) = exp(-σ²/2)

3. Von Mises分布 p(δ) = exp(κcos δ)/2πI₀(κ)：
   χ(1) = I₁(κ)/I₀(κ)

初始和最终斯托克斯参数：
初始：S₁⁽⁰⁾ = |a|² - |b|²，S₂⁽⁰⁾ = 2Re(ab*)，S₃⁽⁰⁾ = 2Im(ab*)

最终：
S₁ = S₁⁽⁰⁾（不变）
S₂ = S₂⁽⁰⁾Re[χ(1)]
S₃ = S₃⁽⁰⁾Re[χ(1)]

偏振度变化：
P_final/P_initial = √[S₁² + (S₂⁽⁰⁾)²|χ(1)|² + (S₃⁽⁰⁾)²|χ(1)|²]/√[S₁² + (S₂⁽⁰⁾)² + (S₃⁽⁰⁾)²]

特殊情况：
- 圆偏振入射（S₁ = 0）：P_final = P_initial|χ(1)|
- 线偏振入射（S₃ = 0）：部分保持
</details>

**练习22.7** 分析Pancharatnam-Berry几何相位。当偏振态在庞加莱球上沿闭合路径C演化时，计算获得的几何相位。
*提示*：几何相位等于路径所围立体角的一半。

<details>
<summary>答案</summary>

偏振态参数化：
|ψ(t)⟩ = cos(θ/2)|H⟩ + sin(θ/2)exp(iφ)|V⟩

对应庞加莱球坐标：(θ, φ)

沿闭路C演化后的几何相位：
γ = (1/2)∮_C A·dl

其中A是"矢势"：
A_θ = 0
A_φ = cos θ - 1

因此：
γ = (1/2)∮_C (cos θ - 1)dφ = -(1/2)Ω

其中Ω是路径所围立体角。

具体例子：

1. 赤道大圆（所有线偏振态）：
   路径：θ = π/2，φ ∈ [0, 2π]
   立体角：Ω = 2π
   几何相位：γ = -π

2. 纬线圆（固定椭圆率）：
   路径：θ = θ₀，φ ∈ [0, 2π]
   立体角：Ω = 2π(1 - cos θ₀)
   几何相位：γ = -π(1 - cos θ₀)

3. 测地三角形：
   顶点：北极、(θ=π/2,φ=0)、(θ=π/2,φ=π/2)
   立体角：Ω = π/2
   几何相位：γ = -π/4

实验验证：
使用三个波片序列实现闭合路径
相位测量：干涉法或偏振分析

应用：
- 几何相位调制器
- 鲁棒量子计算
- 拓扑光子学器件
</details>

**练习22.8** 设计一个Mueller矩阵椭偏测量系统，要求能够完整测量16个矩阵元素。分析测量精度与系统参数的关系。
*提示*：需要至少16个独立测量，考虑条件数优化。

<details>
<summary>答案</summary>

测量方程：
I_k = **a**_k^T **M** **s**_k

其中**s**_k是入射Stokes矢量，**a**_k是分析器矢量。

最优设计原则：
1. 输入态集合{**s**_k}应均匀分布在庞加莱球上
2. 分析器集合{**a**_k}也应均匀分布
3. 最小化条件数κ(W)，其中W是测量矩阵

具体配置：

输入态（4个）：
- H：[1, 1, 0, 0]^T
- V：[1, -1, 0, 0]^T  
- D：[1, 0, 1, 0]^T
- R：[1, 0, 0, 1]^T

分析器（4个）：
- 同上配置

测量矩阵（16×16）：
W_ij = (a_i ⊗ s_j)

Mueller矩阵反演：
vec(**M**) = W^(-1) **I**

其中**I** = [I_1, I_2, ..., I_16]^T

误差分析：

1. 强度噪声：σ_I
   Mueller元素误差：σ_M = κ(W)σ_I/√N

2. 器件误差：
   - 延迟器误差δφ → ΔM ∝ sin(2θ)δφ
   - 方位角误差δθ → ΔM ∝ cos(2θ)δθ

3. 系统校准：
   使用已知样品（空气、标准延迟器）
   最小二乘拟合修正系统误差

优化方案：

1. 双旋转延迟器：
   - 连续测量，过定系统
   - 傅里叶分析提取M_ij
   - 自校准能力

2. 分振幅配置：
   - 4个通道同时测量
   - 减少测量时间
   - 需要精确通道校准

3. 光谱域测量：
   - 利用色散同时获得多个延迟
   - 单次测量获得完整矩阵
   - 光谱分辨率限制

精度极限：
- 散粒噪声：ΔM/M ~ 1/√(N_photons)
- 系统稳定性：~0.1%（温控）
- 最终精度：~10^(-3) - 10^(-4)
</details>

## 常见陷阱与错误

### 概念混淆

1. **偏振与偏振化**
   - 错误：认为非偏振光通过偏振器后"变成"偏振光
   - 正确：偏振器选择性透过某一偏振分量，不改变光的偏振性质

2. **相位差的符号约定**
   - 错误：混淆δ = φ_y - φ_x还是φ_x - φ_y
   - 正确：保持一致的约定，注意与旋向定义的关系

3. **Jones矢量的归一化**
   - 错误：忘记Jones矢量可以包含强度信息
   - 正确：明确是否使用归一化形式，注意物理含义

### 计算错误

4. **矩阵乘法顺序**
   - 错误：**M**_1**M**_2与**M**_2**M**_1混淆
   - 正确：光先通过的器件矩阵在右边

5. **坐标系旋转**
   - 错误：混淆器件旋转与坐标系旋转
   - 正确：**M**' = **R**(-θ)**M****R**(θ)为器件旋转

6. **庞加莱球角度因子**
   - 错误：忘记庞加莱球上使用2ψ和2χ
   - 正确：球面角度是偏振椭圆角度的两倍

### 实验误差

7. **消光比假设**
   - 错误：假设偏振器是理想的
   - 正确：考虑有限消光比对测量的影响

8. **波长依赖性**
   - 错误：忽略波片的色散
   - 正确：校准应在工作波长进行

9. **温度效应**
   - 错误：忽略温度对双折射的影响
   - 正确：监控温度或使用温度补偿设计

### 物理理解

10. **部分偏振光的处理**
    - 错误：试图用Jones矢量描述部分偏振光
    - 正确：使用Stokes参数或相干矩阵

11. **去偏振机制**
    - 错误：认为去偏振是偏振态的破坏
    - 正确：理解为偏振态的统计平均

12. **几何相位的理解**
    - 错误：认为几何相位是动力学效应
    - 正确：纯粹的几何/拓扑效应

## 最佳实践检查清单

### 理论分析
- [ ] 明确偏振态描述方法的适用范围
- [ ] 保持符号约定的一致性
- [ ] 验证能量守恒和幺正性条件
- [ ] 检查极限情况的物理合理性

### 系统设计
- [ ] 选择合适的偏振元件组合
- [ ] 考虑器件的非理想特性
- [ ] 优化系统的条件数
- [ ] 包含校准和对准程序

### 实验测量
- [ ] 使用适当的偏振态采样
- [ ] 实施系统误差校正
- [ ] 监控环境参数（温度、振动）
- [ ] 验证测量的自洽性

### 数据处理
- [ ] 正确实施矩阵反演算法
- [ ] 评估测量不确定度
- [ ] 检查物理约束条件
- [ ] 使用适当的拟合和优化方法

### 应用考虑
- [ ] 匹配理论模型与实际系统
- [ ] 考虑带宽和时间响应
- [ ] 评估环境稳定性要求
- [ ] 制定维护和校准计划